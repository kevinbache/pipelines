apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: my-pipeline-
spec:
  arguments:
    parameters:
    - name: my-pipe-param
      value: '10'
  entrypoint: my-pipeline
  serviceAccountName: pipeline-runner
  templates:
  - dag:
      tasks:
      - arguments:
          parameters:
          - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a
            value: '{{inputs.parameters.loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a}}'
          - name: my-pipe-param
            value: '{{inputs.parameters.my-pipe-param}}'
        name: my-in-coop1
        template: my-in-coop1
      - arguments:
          parameters:
          - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b
            value: '{{inputs.parameters.loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b}}'
        name: my-in-coop2
        template: my-in-coop2
    inputs:
      parameters:
      - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a
      - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b
      - name: my-pipe-param
    name: for-loop-for-loop-e3e70682c2094cac629f6fbed82c07cd-1
  - container:
      args:
      - echo op1 {{inputs.parameters.loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a}}
        {{inputs.parameters.my-pipe-param}}
      command:
      - sh
      - -c
      image: library/bash:4.4.23
    inputs:
      parameters:
      - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a
      - name: my-pipe-param
    name: my-in-coop1
    outputs:
      artifacts:
      - name: mlpipeline-ui-metadata
        optional: true
        path: /mlpipeline-ui-metadata.json
      - name: mlpipeline-metrics
        optional: true
        path: /mlpipeline-metrics.json
  - container:
      args:
      - echo op2 {{inputs.parameters.loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b}}
      command:
      - sh
      - -c
      image: library/bash:4.4.23
    inputs:
      parameters:
      - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b
    name: my-in-coop2
    outputs:
      artifacts:
      - name: mlpipeline-ui-metadata
        optional: true
        path: /mlpipeline-ui-metadata.json
      - name: mlpipeline-metrics
        optional: true
        path: /mlpipeline-metrics.json
  - container:
      args:
      - echo {{inputs.parameters.my-pipe-param}}
      command:
      - sh
      - -c
      image: library/bash:4.4.23
    inputs:
      parameters:
      - name: my-pipe-param
    name: my-out-cop
    outputs:
      artifacts:
      - name: mlpipeline-ui-metadata
        optional: true
        path: /mlpipeline-ui-metadata.json
      - name: mlpipeline-metrics
        optional: true
        path: /mlpipeline-metrics.json
  - dag:
      tasks:
      - arguments:
          parameters:
          - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-a
            value: '{{item.a}}'
          - name: loop-item-placeholder-e3e70682c2094cac629f6fbed82c07cd-item-subvar-b
            value: '{{item.b}}'
          - name: my-pipe-param
            value: '{{inputs.parameters.my-pipe-param}}'
        name: for-loop-for-loop-e3e70682c2094cac629f6fbed82c07cd-1
        template: for-loop-for-loop-e3e70682c2094cac629f6fbed82c07cd-1
        withItems:
        - a: 1
          b: 2
        - a: 10
          b: 20
      - arguments:
          parameters:
          - name: my-pipe-param
            value: '{{inputs.parameters.my-pipe-param}}'
        name: my-out-cop
        template: my-out-cop
    inputs:
      parameters:
      - name: my-pipe-param
    name: my-pipeline